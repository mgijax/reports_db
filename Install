#!/bin/csh

#
# Install
#

cd `dirname $0` && source ./Configuration

sed "s/ftp.informatics.jax.org/$FTPURL/" index.html > index.html.new
mv -f index.html.new index.html

foreach i (index.html)
	cp -r $i ${FTPREPORTDIR}
end

cd daily
set toEdit=`grep -l radar *`
foreach i ($toEdit)
sed "s/radar/$RADAR_DBNAME/g" $i > $i.new
mv -f $i.new $i
end

#
# directories
#

if ( ! -d ${REPORTDIR} ) then
	mkdir -p ${REPORTDIR}
endif

if ( ! -d ${REPORTOUTPUTDIR} ) then
	mkdir -p ${REPORTOUTPUTDIR}
endif

if ( ! -d ${REPORTOUTPUTDIR}/mgimarkerfeed ) then
	mkdir -p ${REPORTOUTPUTDIR}/mgimarkerfeed
endif

if ( ! -d ${REPORTLOGSDIR} ) then
	mkdir -p ${REPORTLOGSDIR}
endif

if ( ! -d ${INPARANOIDDIR} ) then
	mkdir -p ${INPARANOIDDIR}
endif

# link the GO gene association file into weekly so that it runs from there as well

cd ${PUBRPTS}/weekly
ln -s ${PUBRPTS}/daily/GO_gene_association.py .

# provide a link to the Mammalian Phenotype vocabulary
cd ${REPORTOUTPUTDIR}
foreach f (${MPFILES})
rm -rf $f
ln -s ${MPVOCSOURCE}/$f .
end

# provide a link to the Adult Mouse Anatomy vocabulary
cd ${REPORTOUTPUTDIR}
foreach f (${MAFILES})
rm -rf $f
ln -s ${MAVOCSOURCE}/$f .
end

#
# permissions
#

cd ${PUBRPTS}
chmod 664 Configuration* HISTORY *.html
chmod 775 *.sh */*.py */*.sql Install
chmod 775 daily monthly weekly

